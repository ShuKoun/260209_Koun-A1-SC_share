

---

# Paper B: Theory & Phenomenological Analysis (Safety-Rewritten)

## 標題（Title）

**Beyond Numerical Convergence: Residual Floors and Noise-Tolerant Dynamics in High-Resolution Semiconductor Simulation**

（超越数值收敛：高分辨率半导体模拟中的残差地板与噪声容忍动力学）

---

## 摘要（Abstract）

在高度刚性的非线性半导体仿真中，传统数值分析通常将“残差持续下降”作为算法成功的主要判据。然而，在高分辨率离散、强指数非线性与边界约束并存的条件下，残差往往在某一有限量级附近进入平台状态，而不再表现出单调下降。本文基于 **Koun-A1-SC** 协议在 $120 \times 60$ 网格、强摻杂突变二维模型上的实验日志，对这一现象进行了系统性分析。

我们指出，该平台并不必然意味着算法失败，而更可能反映了离散算子、物理模型与数值稳定性之间的综合极限。本文首先分析了在强伪瞬态延拓（PTC）条件下，Krylov 子空间方法与 Dirichlet 边界约束之间可能出现的 **边界冻结（Boundary Locking）** 现象，并说明了 **边界消元（Boundary Elimination）** 在数值结构上的合理性。随后，我们讨论了在残差平台附近观测到的微小能量波动，将其解释为离散化与浮点误差背景下的 **噪声主导区间（Noise-Dominated Regime）**。最后，我们提出一种 **噪声容忍的稳定演化视角**：当进一步残差下降不再可靠时，允许解在受限能量带内进行受控演化，可以显著提升求解过程的鲁棒性与可持续性。

---

## 1. 引言：关于“收敛”的再审视

*(Introduction: Re-examining the Meaning of Convergence)*

在经典数值分析框架中，非线性方程组的求解通常以残差范数
$$
|F(x)|
$$
是否持续下降并趋近于机器精度作为主要成功标准。然而，这一标准隐含了一个前提：离散问题在给定分辨率下仍然具备可被充分逼近的连续解结构。

在半导体漂移-扩散模型中，该前提并不总是成立。泊松-玻尔兹曼型项
$$
\exp(\phi / V_T)
$$
在高摻杂突变区域引入了极端的非线性尺度差异，使得：

1. 雅可比矩阵的条件数随电势分布发生剧烈变化；
2. 离散算子在有限网格下无法同时满足物理精度与数值稳定性；
3. 牛顿类方法在残差较低时，更新方向对离散误差高度敏感。

在这种背景下，本文不再将“残差是否继续下降”作为唯一评价维度，而是转而分析：
**当残差下降停止时，系统实际上处于何种数值与物理状态？**

---

## 2. 边界冻结现象的数值机制

*(Boundary Locking under PTC-Krylov Dynamics)*

### 2.1 PTC-Krylov 线性系统回顾

在引入伪瞬态延拓（Pseudo-Transient Continuation, PTC）后，非线性更新通常通过求解以下线性系统获得：

$$
\left( \frac{1}{dt} I - J(\phi_k) \right), \delta \phi = F(\phi_k),
$$

其中 $dt$ 为伪时间步长，$J(\phi_k)$ 为残差算子的雅可比。

当 $dt$ 较小时，该算子以 $\frac{1}{dt} I$ 为主导项，从而显著增强数值稳定性。

### 2.2 边界节点的谱结构差异

对于 Dirichlet 边界条件，边界节点在离散系统中的对应行通常：

* 非零元素极少；
* 对角元素较大或被强制设定。

在 $dt \to 0$ 的情况下，算子
$$
A = \frac{1}{dt} I - J
$$
在边界节点与内部节点之间呈现出明显不同的谱尺度。

### 2.3 Krylov 子空间的数值偏置

基于 GMRES 的 Krylov 方法倾向于优先降低对整体残差贡献更“可见”的分量。在实际实验中观察到：

* 内部节点残差迅速下降；
* 边界相关残差在若干迭代中变化极小。

本文将这一现象描述为 **边界冻结（Boundary Locking）**：
并非边界条件被“错误处理”，而是在强正则化下，Krylov 子空间对其更新不敏感。

### 2.4 边界消元的数值合理性

在 **Boundary Elimination** 策略中：

* 边界节点不再作为未知量；
* 边界值被视为算子定义的一部分；
* 线性系统仅在内部自由度上求解。

这一处理在数值结构上消除了边界与内部自由度之间的谱不对称性，并在实验中显著改善了更新一致性。

---

## 3. 残差地板与噪声主导区间

*(Residual Floors and Noise-Dominated Regimes)*

### 3.1 实验观察

在 $120 \times 60$ 网格的二维模型中，残差范数在下降至约
$$
|F| \sim 10^{-3}
$$
后进入平台期，并在后续迭代中仅表现为微小波动。

### 3.2 离散化与模型极限

该平台可合理理解为多种因素的叠加结果：

* 有限差分算子在强梯度区域的截断误差；
* 指数非线性导致的局部数值放大；
* 浮点舍入误差在高刚性条件下的积累。

因此，这一“残差地板”并不必然对应于连续模型意义下的误解，而更可能反映：

$$
|F_h(\phi)| \approx \epsilon_{\text{disc}} + \epsilon_{\text{num}},
$$

其中 $\epsilon_{\text{disc}}$ 与网格尺度相关，$\epsilon_{\text{num}}$ 与数值表示精度相关。

### 3.3 噪声主导区间的行为特征

在残差地板附近，目标函数（Merit Function）

$$
\Phi = \frac{1}{2}|F|^2
$$

的变化量表现为：

$$
\Delta \Phi \in [-\epsilon, +\epsilon], \quad \epsilon \ll \Phi.
$$

在该区间内：

* 牛顿方向不再稳定指向下降方向；
* 小幅“上升”与“下降”难以区分其物理意义。

本文将此区间称为 **噪声主导区间（Noise-Dominated Regime）**。

---

## 4. 噪声容忍的稳定演化视角

*(Noise-Tolerant Stable Evolution)*

### 4.1 从“最小化”到“维持稳定”

在噪声主导区间内，继续强制执行严格下降准则往往导致：

* 步长反复缩小；
* 数值停滞；
* 甚至算法提前终止。

Koun-A1-SC 在该阶段采用了 **噪声容忍的接受策略**：

$$
\Phi_{\text{new}} \le \Phi_{\text{old}} + \text{atol},
$$

其中 $\text{atol}$ 与平台期的能量波动量级匹配。

### 4.2 稳定演化的数值意义

在接受噪声级更新后，系统表现为：

* 解变量在狭窄能量带内缓慢变化；
* 伪时间步长 $dt$ 得以维持或增长；
* 数值状态保持稳定而非振荡。

这种行为并不意味着“进一步逼近真实解”，而是：

> 在当前离散与物理分辨率下，维持一个数值上稳定、物理上合理的解状态。

### 4.3 对求解目标的重新表述

在这一阶段，求解目标可被更谨慎地表述为：

$$
\text{Find } \phi \text{ such that } |F_h(\phi)| \le |F_h|_{\text{floor}} + \delta,
$$

而非无限制地追求 $|F_h| \to 0$。

---

## 5. 讨论与方法论启示

*(Discussion and Methodological Implications)*

### 5.1 对数值算法设计的启示

本文的分析表明，在高度刚性的实际问题中：

* 严格单调收敛并非总是合理目标；
* 稳定性、可持续性与数值一致性同样重要。

引入结构化的诊断与容忍机制，有助于避免将数值极限误判为算法失败。

### 5.2 对工程仿真的意义

对于工程仿真工具而言，这一视角提示：

* 自动化求解器应具备识别“可进一步优化”与“已达数值极限”的能力；
* 用户干预（如手动 Ramping）并非唯一途径。

---

## 6. 结论（Conclusion）

本文通过对 Koun-A1-SC 实验行为的系统分析，展示了在高分辨率、强非线性半导体模型中，残差平台、边界冻结与噪声主导区间的数值成因。通过边界消元、噪声容忍接受准则以及 PTC-Krylov 动力学的组合，可以在不强行突破数值极限的前提下，获得稳定且可持续的求解过程。

这一结果并不否认收敛的重要性，而是指出：**在某些问题中，稳定地“停留在可行区间”本身就是一种合理的成功。**

---

