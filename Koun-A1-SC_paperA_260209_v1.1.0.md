

### **Koun-A1-SC：極端剛性半導體 Poisson–Boltzmann 系統冷啟動的結構型算法治理協議**

**（英文副標題）**
**Koun-A1-SC: A Structural Algorithmic Governance Protocol for Cold-Start Simulation of Extremely Stiff Semiconductor Poisson–Boltzmann Systems**



---



### **摘要（Abstract）**

半導體器件模擬中的 Poisson–Boltzmann 類平衡模型，由於載流子濃度與電勢之間的指數耦合關係，呈現出極端的數值剛性（stiffness）。在缺乏良好初值的情況下，傳統牛頓類方法（Newton–Raphson）往往因過衝或數值溢出而失效，實務中通常依賴人工設計的偏壓或摻雜漸進策略（ramping）來維持收斂。

本文提出 **Koun-A1-SC**，作為 **Koun-A1 算法治理框架** 在半導體 Poisson–Boltzmann 系統中的一個具體實例。與將可解性視為數值技巧的傳統觀點不同，Koun-A1-SC 將求解過程建模為一個具備結構化決策邏輯的治理協議。該協議以 **偽瞬態延拓（Pseudo-Transient Continuation, PTC）** 作為單一權威的生存底座，通過動態調節偽時間步長來在「穩定生存」與「牛頓加速」之間連續切換；同時結合 **邊界消元（Boundary Elimination）** 以解除 Krylov 子空間方法在強剛性 Dirichlet 邊界下的拓撲凍結問題。

在此基礎上，我們引入了一套 **一致性的事件分類與雙重容忍（dual tolerance）準則**，用以區分真實發散、数值噪聲主導的殘差平台，以及健康但缓慢的演化阶段。這一機制避免了傳統严格下降判據在殘差地板附近所导致的假性失效（false failure），使求解器能够在高解析度（$120 \times 60$ 网格）和极端摻杂突变条件下，从零初值冷启动并保持稳定、可解释的演化行为。

数值实验表明，Koun-A1-SC 并不试图在离散化误差主导的残差平台上强行追求进一步下降，而是能够识别并进入一种 **受控漂移（controlled drift）** 状态：系统在维持稳定性的同时，以可控方式遍历解空间的平坦区域，而不会触发非必要的步长崩溃或错误中止。

这些结果表明，将 **算法治理（algorithmic governance）** 作为一等设计目标，而非事后补救策略，是处理极端刚性半导体平衡问题的一条有效路径。

---



---

## **1. 引言（Introduction）——安全版全文替換稿**

### **1. 引言（Introduction）**

在非線性偏微分方程的數值求解研究中，「可解性（solvability）」通常被理解为算法本身的性质：若模型与离散方式合理，则应存在某种数值方法能够找到解。然而，在高度刚性的物理系统中，这一假设往往在实践中失效。

半导体 Poisson–Boltzmann 类平衡模型提供了一个典型例子。由于载流子浓度与电势之间存在指数型耦合关系（如 $\exp(\phi / V_T)$），系统的雅可比矩阵条件数会随着电势幅度、掺杂突变以及网格加密迅速恶化。在缺乏良好初值的情况下，标准 Newton–Raphson 方法即使配合阻尼或线搜索，也常因过冲、数值溢出或误判发散而失败。

在工程实践中，主流 TCAD 工具通常通过 **连续性参数扫描（continuation / ramping）** 来规避这一问题，例如逐步增加掺杂强度或偏压幅度。虽然该策略在多数情况下有效，但其稳定性高度依赖使用者的经验与问题特定调参方式。这意味着，算法本身并未内生地解决可解性问题，而是将其外包给人工流程。

本文采取一种不同的立场：**可解性并非纯粹的数值技巧问题，而是一种需要被显式管理的系统状态**。基于这一观点，我们引入 **Koun-A1 算法治理框架**，并在半导体 Poisson–Boltzmann 系统中构建其具体实例 **Koun-A1-SC**。

Koun-A1-SC 并非试图发明一种新的数值求解方法，而是将求解过程本身建模为一个**具备结构化决策逻辑的治理协议**。该协议通过持续监测系统状态，并在不同阶段切换求解策略，从而在不依赖外部 ramping 的前提下维持算法的稳定演化。

本文的核心贡献可总结为以下三点：

1. **生存层的明确化（Survival Layer）**
   我们将伪瞬态延拓（Pseudo-Transient Continuation, PTC）确立为求解过程的单一全局化控制机制，以伪时间步长 $dt$ 取代传统线搜索因子 $\alpha$ 作为主要稳定性调节变量。该设计保证了算法在远离解区域时不会因指数非线性而立即崩溃。

2. **拓扑死锁的识别与解除（Topological Deadlock Resolution）**
   在高刚性与强边界约束条件下，Krylov 子空间方法可能出现边界相关的数值冻结现象。我们通过边界消元（Boundary Elimination）对线性系统的拓扑结构进行修正，从而避免边界残差在强正则化阶段被永久锁死。

3. **治理逻辑的一致性修复（Logical Coherence of Governance）**
   传统算法常在接受准则（acceptance criteria）与诊断逻辑（diagnostics）之间存在隐性冲突，导致假性失败（false failure）。Koun-A1-SC 引入了一套一致的事件分类与双重容忍机制，用以区分真实发散、数值噪声主导的残差平台，以及健康但缓慢的演化阶段。

需要强调的是，Koun-A1-SC 的目标并非在所有情况下强行压低残差，而是**避免在离散化误差或数值噪声主导的区域触发不必要的算法崩溃**。这种设计使求解器能够在高解析度和极端掺杂条件下，从零初值冷启动并保持可解释、可审计的演化行为。

---






---

## **2. 治理架構實例化（Instantiating the Framework）——安全版替換稿**

Koun-A1-SC 不是單一數值技巧，而是一套以「事件—決策」驅動的治理協議：在每一步迭代中，求解器不僅計算候選更新方向，也同時評估其可接受性與系統所處狀態，並依此調節全局化控制變量（如偽時間步長 $dt$）或觸發救援路徑。

為了在高度剛性的 Poisson–Boltzmann 半導體系統上實作此治理思想，我們將協議設計拆成三個互相解耦但順序明確的層次：生存層、事件層、救援層。

### **2.1 生存層：偽瞬態延拓（The Survival Base: PTC）**

在高度剛性的非線性系統中，直接求解 $F(\phi)=0$ 的 Newton 步，往往因局部线性化不再代表全局几何而失败。为此我们引入偽瞬態延拓（PTC），将稳态根求解过程嵌入一个“伪时间演化”结构，使得远离解区时优先保证生存性。

在每一轮迭代 $k$，我们考虑线性子问题的 shifted 形式：

$$
\left(\frac{1}{dt_k}I - J(\phi_k)\right),\delta\phi_k = F(\phi_k),
$$

其中 $J(\phi_k)=\frac{\partial F}{\partial \phi}\big|_{\phi_k}$，$dt_k$ 为伪时间步长（治理变量）。

* 当 $dt_k \to 0$ 时，算子趋近 $\frac{1}{dt_k}I$ 主导，对应更新近似 $\delta\phi_k \approx dt_k,F(\phi_k)$，提供稳定的“生存推进”。
* 当 $dt_k \to \infty$ 时，算子趋近 $-J(\phi_k)$，回到 Newton 型加速行为。

**治理原则：** 在 Koun-A1-SC 中，$dt$ 被视为唯一的全局化权威（single authority）。当系统表现为可接受推进时，$dt$ 允许增长；当出现不可接受的上升或拒绝事件时，$dt$ 才收缩以增强正则化。此设计避免了同时由多个全局化机制（如 $dt$、$\alpha$、以及额外 clamp）互相否决而引发的内耗。

### **2.2 事件层：一致性分类与双重容忍（Structural Sentinel: Coherent Noise Classification）**

在残差进入平台区（residual plateau）时，严格下降判据往往会把数值噪声或离散误差主导下的微小波动误判为“失效”，从而触发不必要的救援与步长崩溃。为避免这类假性失败（false failure），Koun-A1-SC 引入一致性事件分类与双重容忍（dual tolerance）。

我们以二次型 merit 函数作为统一的评估基准：

$$
\Phi(\phi) = \frac12 |F(\phi)|^2.
$$

对候选步 $\phi_{k}^{\text{trial}}=\phi_k+\alpha,\delta\phi_k$（$\alpha$ 为内部线搜索变量，但在协议上不是主权变量），我们采用带容忍的接受条件：

$$
\Phi(\phi_{k}^{\text{trial}})\le \Phi(\phi_k) + \text{atol},
$$

其中 $\text{atol}$ 表示噪声/平台尺度下允许的能量波动上界。该规则的目的不是追求“允许变差”，而是避免将不可避免的微小数值波动误判为危机。

在实现上，Koun-A1-SC 将每一步归类为：

* **[STEP]**：候选步被接受且表现为有效下降（$ \Phi(\phi_{k}^{\text{trial}}) < \Phi(\phi_k)$）。
* **[NOISE]**：候选步被接受但变化落在容忍区间内（$0 \le \Phi(\phi_{k}^{\text{trial}})-\Phi(\phi_k)\le \text{atol}$）。
* **[UPHILL]/[REJECT]**：候选步不满足可接受条件，或线搜索未能找到满足容忍条件的候选。

**关键约束（防内耗）：** 一旦线搜索在容忍准则下接受了一个候选步，则治理层必须一致地将其作为可通过事件处理（通常是 [STEP] 或 [NOISE]），而不能同时把该步标记为失败并触发惩罚机制。这一点是协议从 v1.3.4/v1.3.5 走向 v1.3.6 的关键修复点。

### **2.3 救援层：多尺度狙击（The Rescue Family: Multi-Scale Sniper）**

当出现真实的不可接受事件（如 [UPHILL] 或 [REJECT]），协议才允许进入救援家族。救援不被视为主收敛机制，而是治理框架下的授权介入者，用于在局部结构性断裂或线性候选方向不可用时维持系统可演化性。

以 $\Phi(\phi)$ 为目标，梯度为：

$$
\nabla \Phi(\phi) = J(\phi)^{\mathsf T}F(\phi).
$$

我们采用基于梯度的救援方向，并进行尺度归一化（与残差量级对齐）：

$$
d_{\text{rescue}} = -,\nabla \Phi(\phi)\cdot \frac{|F(\phi)|}{|\nabla\Phi(\phi)|+\epsilon}\cdot \lambda,
$$

其中 $\lambda$ 属于一组离散尺度集合（多尺度搜索），例如 $\lambda \in {0.1,0.05,0.01,0.005,0.001}$。多尺度的目的在于避免单一尺度在高刚性地形上变成“盲射”：只有当某一尺度满足容忍接受条件时，救援才被视为命中（HIT）。

---

## **3. 關鍵技術實現（Key Technical Implementations）**

本节仅描述支撑上述治理逻辑的关键技术结构，并避免对未实现机制做过度承诺。

### **3.1 無矩陣 Krylov：Matrix-Free GMRES with JVP**

在 $120\times 60$ 网格下，未知量数量为 $N=7200$（在边界消元后为内部自由度 $N_{\text{in}}=(N_x-2)(N_y-2)=6844$）。显式构建稠密 Jacobian 代价为 $O(N^2)$ 存储与 $O(N^3)$ 求解，因而在高解析度下不可取。

Koun-A1-SC 采用无矩阵（matrix-free）方式实现 Krylov 求解：通过自动微分计算雅可比–向量积（JVP）来定义线性算子对任意向量 $v$ 的作用：

$$
J(\phi),v ;=;\left.\frac{d}{d\epsilon}F(\phi+\epsilon v)\right|_{\epsilon=0}.
$$

在 PTC shifted 系统中，线性算子为：

$$
A(\phi;dt),v = \frac{1}{dt}v - J(\phi),v.
$$

因此 GMRES 仅需反复调用 $A(\cdot)$ 的 matvec，即可构造 Krylov 子空间并得到近似解。

### **3.2 拓撲修正：邊界消元（Boundary Elimination）**

在早期实验中，我们观察到边界残差可能在某些组合配置下出现冻结现象（boundary deadlock）：即便内部残差下降，边界相关误差却长期停滞，从而导致整体演化进入非物理的锁死状态。

为避免 Krylov 在强边界约束下对边界子系统失明，Koun-A1-SC 采用边界消元：将边界节点从未知量中剔除，仅对内部节点求解。边界条件不再作为“需要被迭代修正的变量”，而是作为固定参数直接写入残差算子的 stencil。

形式上，令 $\phi_{\text{in}}$ 为内部未知量，$\phi$ 为重建后的全场，则残差函数被重写为仅作用在内部节点上：

$$
F_{\text{in}}(\phi_{\text{in}}) = 0,
$$

并通过重建映射 $\phi = \mathcal{R}(\phi_{\text{in}})$ 将边界值注入 stencil 计算。该修正确保边界误差在定义上不再成为 Krylov 的自由度来源，从而避免边界死锁现象。

### **3.3 對角預處理：Jacobi / Diagonal Scaling**

为提升 GMRES 在高刚性系统中的可解性，我们采用简单的对角预处理（Jacobi/diagonal scaling）。以 $A(\phi;dt)$ 为目标算子，其对角近似可由离散拉普拉斯主对角项与载流子源项的局部导数构成。对内部点的近似对角可写为：

$$
\operatorname{diag}(J)\approx -\frac{2}{dx^2}-\frac{2}{dy^2}-\frac{q}{\epsilon V_T},(n+p),
$$

从而：

$$
\operatorname{diag}(A)\approx \frac{1}{dt} - \operatorname{diag}(J).
$$

预处理以逐点缩放的方式作用于 GMRES 的线性系统与残差评估，使线性子问题更稳定地提供可用候选方向。

---






---

## **4. 数值证据（Numerical Evidence）**

本节给出 Koun-A1-SC 在极端刚性条件下的数值表现，用以验证该协议在**冷启动、强非线性和高解析度**场景中的稳定性与行为一致性。需要强调的是，以下结果并不以“持续残差下降”为唯一成功标准，而是关注算法在接近离散化极限时的**可解释演化行为**。

### **4.1 实验设置（Experimental Setup）**

所有实验均基于二维 Poisson–Boltzmann 平衡模型，配置如下：

* **计算网格：** $120 \times 60$ 规则二维网格（总网格点 $7200$，内部自由度 $6844$）。
* **物理模型：** 半导体 PN 结平衡态模型，载流子密度满足
  $$
  n = n_i \exp\left(\frac{\phi}{V_T}\right), \quad
  p = n_i \exp\left(-\frac{\phi}{V_T}\right).
  $$
* **掺杂分布：** 左右区域掺杂符号相反（$+10^{16}$ / $-10^{16}$），并在几何中心引入高掺杂岛以制造局部刚性突变。
* **边界条件：** Dirichlet 边界经边界消元处理后作为固定参数嵌入算子；线性系统仅包含内部节点。
* **初始条件：** 全零电势冷启动（Zero Cold Start），无任何外部 ramping 或 continuation。

### **4.2 演化阶段划分（Observed Evolution Phases）**

根据 v1.3.6 的完整运行日志，求解过程可稳定划分为以下两个阶段。

#### **阶段 I：生存与快速稳定期（Survival and Stabilization Phase）**

在初始迭代（约 Iter 0–15）中，系统处于小伪时间步长 $dt$ 控制下。此时 PTC 主导演化，线性算子形态近似为
$$
\left(\frac{1}{dt} I - J(\phi)\right),
$$
显著增强了对角占优性，从而抑制指数项带来的过冲风险。

在该阶段中，残差范数从
$$
|F| \approx 1.8 \times 10^{12}
$$
迅速下降至
$$
|F| \approx 2.0 \times 10^{-3},
$$
整个过程未出现数值溢出或步长崩溃现象。这一行为对应传统方法中通常需要人工 ramping 才能实现的“安全进入解域”过程。

#### **阶段 II：平台期与受控漂移（Plateau and Controlled Drift）**

在 Iter 16 之后，残差进入约
$$
|F| \approx 1.9 \times 10^{-3}
$$
的稳定区间。进一步下降在数值上变得极为缓慢，且单步变化主要受浮点噪声与离散化误差主导。

与传统严格下降策略不同，Koun-A1-SC 在此阶段通过 **双重容忍与一致性分类机制** 将该状态识别为 **[NOISE]**，而非发散或失败：

* 线搜索允许满足
  $$
  \Phi_{\text{new}} \le \Phi_{\text{old}} + \text{atol}
  $$
  的微小波动；
* 治理层不会因噪声级上浮触发救援或强制步长缩减；
* 伪时间步长 $dt$ 继续缓慢增长，使系统以稳定方式遍历平坦解空间。

需要指出的是，在该阶段中 **残差并未被宣称“继续收敛”**。相反，算法明确进入一种 **受控漂移（Controlled Drift）** 状态：数值演化保持稳定、无假性失败，但不强行突破由模型与网格共同决定的残差地板。

### **4.3 对比意义（Interpretation）**

从数值行为角度看，Koun-A1-SC 与传统方法的关键差异并不在于最终残差的绝对大小，而在于：

* 是否将噪声主导的平台期误判为发散；
* 是否在缺乏下降方向时触发不可逆的步长崩溃；
* 是否需要人为介入以维持计算过程“活着”。

在相同物理与网格条件下，Koun-A1-SC 展现出一致、可重复且无需人工调参的演化轨迹。

---

## **5. 结论（Conclusion）**

本文提出的 **Koun-A1-SC** 展示了一种不同于传统数值求解器的设计思路：将极端刚性问题的求解过程视为一个需要持续决策的**算法治理过程**，而非单纯的“寻找下降方向”的数值优化任务。

通过将 **伪瞬态延拓（PTC）** 确立为全局生存层、对边界条件进行拓扑消元、并引入逻辑自洽的事件分类与容忍机制，Koun-A1-SC 在无需任何外部 ramping 的情况下，实现了高解析度半导体 Poisson–Boltzmann 系统的冷启动与稳定演化。

值得强调的是，本工作**并未声称突破离散化或物理误差极限**。相反，其核心贡献在于：当系统抵达数值与模型共同决定的残差地板时，算法能够识别这一结构性限制，并进入一种稳定、可解释、无假性失败的演化状态。

从更广泛的角度看，这一结果表明：
在高度刚性的物理系统中，**“保持可演化性”本身是一种一等算法目标**。通过将稳定性、诊断与策略切换显式纳入算法设计，数值求解器可以从依赖人工经验的工具，转变为具备内在自我调节能力的计算系统。

这些观察为后续研究提供了两个方向：其一是对残差地板的物理与离散来源进行更系统的分析（Paper B）；其二是探索类似治理协议在更复杂耦合系统中的适用性。在此意义上，Koun-A1-SC 提供的是一种可复用的结构化思路，而非特定方程的专用技巧。

---

